<?xml version="1.0" encoding="UTF-8" ?>
<sect1 version="5.0" xmlns="http://docbook.org/ns/docbook" xmlns:ns6="http://www.w3.org/1999/xlink" xmlns:ns5="http://www.w3.org/1999/xhtml" xmlns:ns4="http://www.w3.org/2000/svg" xmlns:ns3="http://www.w3.org/1998/Math/MathML" xmlns:ns="http://docbook.org/ns/docbook" >
  <title>J2KProcessReachRouting</title>
  <subtitle>A component used for the modeling of flow processes in the reaches of the
    catchment area.</subtitle>
  <informaltable>
    <tgroup cols="2">
      <colspec colname="c1" colnum="1" colwidth="1*"/>
      <colspec colname="c2" colnum="2" colwidth="3*"/>
      <thead>
        <row>
          <entry nameend="c2" namest="c1">Metadata</entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry>classification</entry>
          <entry>j2k.routing</entry>
        </row>
      </tbody>
    </tgroup>
  </informaltable>
  <sect2>
    <title>Variables</title>
  <informaltable>
    <tgroup cols="2">
      <colspec colname="c1" colnum="1" colwidth="1*"/>
      <colspec colname="c2" colnum="2" colwidth="3*"/>
      <thead>
        <row>
          <entry>Name</entry>
          <entry>Description</entry>
        </row>
      </thead>
      <tbody>
        <row>
          <entry>entities</entry>
          <entry>the reach collection</entry>
        </row>
        <row>
          <entry>length</entry>
          <entry>reach length [m]</entry>
        </row>
        <row>
          <entry>slope</entry>
          <entry>reach slope [(start_elevation-end_elevation)/length]</entry>
        </row>
        <row>
          <entry>width</entry>
          <entry>reach width [m]</entry>
        </row>
        <row>
          <entry>roughness</entry>
          <entry>reach roughness according to Manning-Strickler [-]</entry>
        </row>
        <row>
          <entry>inRD1</entry>
          <entry>inflow of the component RD1 into the reach</entry>
        </row>
        <row>
          <entry>inRD2</entry>
          <entry>inflow of the component RD2 into the reach</entry>
        </row>
        <row>
          <entry>inRG1</entry>
          <entry>inflow of the component RG1 into the reach</entry>
        </row>
        <row>
          <entry>inRG2</entry>
          <entry>inflow of the component RG2 into the reach</entry>
        </row>
        <row>
          <entry>inAddIn</entry>
          <entry>additional inflow, e.g. from upstream river catchments </entry>
        </row>
        <row>
          <entry>outRD1</entry>
          <entry>outflow of component RD1 from the reach</entry>
        </row>
        <row>
          <entry>outRD2</entry>
          <entry>outflow of component RD2 from the reach</entry>
        </row>
        <row>
          <entry>outRG1</entry>
          <entry>outflow of component RG1 from the reach</entry>
        </row>
        <row>
          <entry>outRG2</entry>
          <entry>outflow of component RG2 from the reach</entry>
        </row>
        <row>
          <entry>outAddIn</entry>
          <entry>outflow generated by additional inflow </entry>
        </row>
        <row>
          <entry>simRunoff</entry>
          <entry>sum of simulated runoff in the reach</entry>
        </row>
        <row>
          <entry>actRD1</entry>
          <entry>current storage of the component RD1 in the reach</entry>
        </row>
        <row>
          <entry>actRD2</entry>
          <entry>current storage of the component RD2 in the reach</entry>
        </row>
        <row>
          <entry>actRG1</entry>
          <entry>current storage of the component RG1 in the reach</entry>
        </row>
        <row>
          <entry>actRG2</entry>
          <entry>current storage of the component RG2 in the reach</entry>
        </row>
        <row>
          <entry>actAddIn</entry>
          <entry>current storage of additional inflow </entry>
        </row>
        <row>
          <entry>channelStorage</entry>
          <entry>sum of current storage</entry>
        </row>
        <row>
          <entry>flowRouteTA</entry>
          <entry>calibration parameter for adapting velocity [0 .. posInf]</entry>
        </row>
        <row>
          <entry>catchmentRD1</entry>
          <entry>storage of component RD1 (only catchment outlet) </entry>
        </row>
        <row>
          <entry>catchmentRD2</entry>
          <entry>storage of component RD2 (only catchment outlet) </entry>
        </row>
        <row>
          <entry>catchmentRG1</entry>
          <entry>storage of component RG1 (only catchment outlet) </entry>
        </row>
        <row>
          <entry>catchmentRG2</entry>
          <entry>storage of component RG2 (only catchment outlet) </entry>
        </row>
        <row>
          <entry>catchmentAddIn</entry>
          <entry>storage of additional component (only catchment outlet) </entry>
        </row>
        <row>
          <entry>catchmentSimRunoff</entry>
          <entry>sum of storages (only catchment outlet) </entry>
        </row>
        <row>
          <entry>tempRes</entry>
          <entry>temporal resolution [d or h]</entry>
        </row>
        <row>
          <entry>reachID</entry>
          <entry>numerical ID of the reach</entry>
        </row>
      </tbody>
    </tgroup>
  </informaltable>
  </sect2>
  <sect2>
    <title>Component Description</title>
    <para>This component is used for modeling flow processes in the reach network of
      the catchment area. First, separate reaches have to be parameterized. The individual
      parameters which have to be assigned, are length in meters, slope in %, the mean width in
      meters and the reach roughness according to Manning-Strickler. Those are stored in a parameter
      file which is read by the model and by which the corresponding objects are generated.
      Additionally, the file contains information on the structure of the flow topology by noting
      the ID for every reach into which it empties. The reach representing the catchment outlet has
      to contain the ID 0. </para>
    <para>The individual reaches receive water by neighboring spatial model entities and upstream
      reaches. In the reach, a velocity for water amount is calculated and then a certain amount is
      given to the next downstream reach based on the velocity and the length of the reach. 
      For the calculation a rectangular cross section is assumed to simplify matters.
      Although the complete amount of water is routed, the relative amounts of the individual runoff
      components are maintained, so they can be considered separately anytime and in every reach. </para>
    <para>The module describes flow processes in the channel by using the kinematic wave approach
      and the calculation of velocity according to Manning &amp; Strickler. The only parameter that
      has to be set by the user  (<inlineequation>
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>T</ns3:mi>
            <ns3:mi>A</ns3:mi>
          </ns3:mrow>
        </ns3:math>
      </inlineequation>) is a routing coefficient. It represents the runtime of the runoff wave
      which moves in the channel until it reaches the catchment outlet after a precipitation event.
      Its value is required for the calculation of the restraint coefficient (<inlineequation>
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>R</ns3:mi>
            <ns3:mi>k</ns3:mi>
          </ns3:mrow>
        </ns3:math>
      </inlineequation>) together with velocity of the river (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>v</ns3:mi>
        </ns3:math>
      </inlineequation>) and flow length (<inlineequation>
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>f</ns3:mi>
            <ns3:mi>l</ns3:mi>
          </ns3:mrow>
        </ns3:math>
      </inlineequation>): </para>
    <para><equation>
      <mediaobject>
        <imageobject>
          <imagedata align="center">
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mrow>
              <ns3:mi>R</ns3:mi>
              <ns3:mi>k</ns3:mi>
            </ns3:mrow>
            <ns3:mo>=</ns3:mo>
            <ns3:mrow>
              <ns3:mfrac>
                <ns3:mi>v</ns3:mi>
                <ns3:mrow>
                  <ns3:mi>f</ns3:mi>
                  <ns3:mi>l</ns3:mi>
                </ns3:mrow>
              </ns3:mfrac>
              <ns3:mo>×</ns3:mo>
              <ns3:mrow>
                <ns3:mrow>
                  <ns3:mi>T</ns3:mi>
                  <ns3:mi>A</ns3:mi>
                </ns3:mrow>
                <ns3:mo>×</ns3:mo>
                <ns3:mi>3600 [-]</ns3:mi>
              </ns3:mrow>
            </ns3:mrow>
          </ns3:mrow>
        </ns3:math>
            
          </imagedata>
        </imageobject>
      </mediaobject>
    </equation></para>
    <para>Before doing so, the velocity (<inlineequation>
        <ns3:math display="inline">
          <ns3:msub>
            <ns3:mi>v</ns3:mi>
            <ns3:mrow>
              <ns3:mi>n</ns3:mi>
              <ns3:mi>e</ns3:mi>
              <ns3:mi>w</ns3:mi>
            </ns3:mrow>
          </ns3:msub>
        </ns3:math>
      </inlineequation>) has to be determined using the roughness factor by Manning (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>M</ns3:mi>
        </ns3:math>
      </inlineequation>), slope of the river bed (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>l</ns3:mi>
        </ns3:math>
      </inlineequation>) and the hydraulic radius (<inlineequation>
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>R</ns3:mi>
            <ns3:mi>h</ns3:mi>
          </ns3:mrow>
        </ns3:math>
      </inlineequation>). The hydraulic radius is calculated using the drained cross section (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>A</ns3:mi>
        </ns3:math>
      </inlineequation>) of the reach which results from the flow rate (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>q</ns3:mi>
        </ns3:math>
      </inlineequation>), velocity (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>v</ns3:mi>
        </ns3:math>
      </inlineequation>) and river bed width (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>b</ns3:mi>
        </ns3:math>
      </inlineequation>). For this approach, a start velocity (<inlineequation>
        <ns3:math display="inline">
          <ns3:msub>
            <ns3:mi>v</ns3:mi>
            <ns3:mrow>
              <ns3:mi>i</ns3:mi>
              <ns3:mi>n</ns3:mi>
              <ns3:mrow>
                <ns3:mi>i</ns3:mi>
                <ns3:mi>t</ns3:mi>
              </ns3:mrow>
            </ns3:mrow>
          </ns3:msub>
        </ns3:math>
      </inlineequation>) is assumed which is then iteratively adjusted with regard to the new
      calculated velocity (<inlineequation>
        <ns3:math display="inline">
          <ns3:msub>
            <ns3:mi>v</ns3:mi>
            <ns3:mrow>
              <ns3:mi>n</ns3:mi>
              <ns3:mi>e</ns3:mi>
              <ns3:mi>w</ns3:mi>
            </ns3:mrow>
          </ns3:msub>
        </ns3:math>
      </inlineequation>) until both velocities differ in a value smaller than 0,001 m s^{-1}: </para>
    <para><equation>
      <mediaobject>
        <imageobject>
          <imagedata align="center">
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mrow>
              <ns3:mi>R</ns3:mi>
              <ns3:mi>h</ns3:mi>
            </ns3:mrow>
            <ns3:mo>=</ns3:mo>
            <ns3:mfrac>
              <ns3:mi>A</ns3:mi>
              <ns3:mrow>
                <ns3:mi>b</ns3:mi>
                <ns3:mo>+</ns3:mo>
                <ns3:mrow>
                  <ns3:mo>2</ns3:mo>
                  <ns3:mfrac>
                    <ns3:mi>A</ns3:mi>
                    <ns3:mi>b</ns3:mi>
                  </ns3:mfrac>
                </ns3:mrow>
            
              </ns3:mrow>
            </ns3:mfrac>
          </ns3:mrow>
          
          
     
    
          
          <ns3:mi> &#160;</ns3:mi>
          <ns3:mrow>
  
            <ns3:mi>[m]</ns3:mi>
  
          </ns3:mrow>
         
          
          
        </ns3:math>
          </imagedata>
        </imageobject>
      </mediaobject>
    </equation> </para>
    <para>with: </para>
    <para><equation>
      <mediaobject>
        <imageobject>
          <imagedata align="center">
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>A</ns3:mi>
            <ns3:mo>=</ns3:mo>
            <ns3:mfrac>
              <ns3:mi>q</ns3:mi>
              <ns3:msub>
                <ns3:mi>v</ns3:mi>
                <ns3:mrow>
                  <ns3:mi>i</ns3:mi>
                  <ns3:mi>n</ns3:mi>
                  <ns3:mrow>
                    <ns3:mi>i</ns3:mi>
                    <ns3:mi>t</ns3:mi>
                  </ns3:mrow>
                  
                </ns3:mrow>
              </ns3:msub>
            </ns3:mfrac>
          </ns3:mrow>
         
          <ns3:mi> &#160;</ns3:mi>
          <ns3:mrow>
   
            
            <ns3:mi>[m²]</ns3:mi>
 
          </ns3:mrow>
          
        </ns3:math>
          </imagedata>
        </imageobject>
      </mediaobject>
    </equation> </para>
  
    <para><equation>
      <mediaobject>
        <imageobject>
          <imagedata align="center">
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:msub>
              <ns3:mi>v</ns3:mi>
              <ns3:mrow>
                <ns3:mi>n</ns3:mi>
                <ns3:mi>e</ns3:mi>
                <ns3:mi>w</ns3:mi>
              </ns3:mrow>
            </ns3:msub>
            <ns3:mo>=</ns3:mo>
            <ns3:mrow>
              <ns3:mi>M</ns3:mi>
              <ns3:mo>×</ns3:mo>
              <ns3:mrow>
                <ns3:msup>
                  <ns3:mrow>
                    <ns3:mi>R</ns3:mi>
                    <ns3:mi>h</ns3:mi>
                  </ns3:mrow>
                  <ns3:mfrac>
                    <ns3:mi>2</ns3:mi>
                    <ns3:mi>3</ns3:mi>
                  </ns3:mfrac>
                </ns3:msup>
                <ns3:mo>×</ns3:mo>
                <ns3:msup>
                  <ns3:mi>l</ns3:mi>
                  <ns3:mfrac>
                    <ns3:mi>1</ns3:mi>
                    <ns3:mi>3</ns3:mi>
                  </ns3:mfrac>
                  </ns3:msup>
              </ns3:mrow>
              
            </ns3:mrow>
          </ns3:mrow>
          
          <ns3:mi> &#160;</ns3:mi>
          <ns3:mrow>
 
            <ns3:mi>[m³/s]</ns3:mi>
   
          </ns3:mrow>
          
        </ns3:math>
          </imagedata>
        </imageobject>
      </mediaobject>
    </equation> </para>
    <para>Finally, the amount of water of the corresponding reach  (<inlineequation>
        <ns3:math display="inline">
          <ns3:msub>
            <ns3:mi>q</ns3:mi>
            <ns3:mrow>
              <ns3:mi>a</ns3:mi>
              <ns3:mi>c</ns3:mi>
              <ns3:mi>t</ns3:mi>
            </ns3:mrow>
          </ns3:msub>
        </ns3:math>
      </inlineequation>) is calculated which goes to the runoff  (<inlineequation>
        <ns3:math display="inline">
          <ns3:mi>q</ns3:mi>
        </ns3:math>
      </inlineequation>) using the runoff restraint coefficient  (<inlineequation>
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>R</ns3:mi>
            <ns3:mi>k</ns3:mi>
          </ns3:mrow>
        </ns3:math>
      </inlineequation>)  which has been generated. </para>
    <para><equation>
      <mediaobject>
        <imageobject>
          <imagedata align="center">
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>q</ns3:mi>
            <ns3:mo>=</ns3:mo>
            <ns3:mrow>
              <ns3:msub>
                <ns3:mi>q</ns3:mi>
                <ns3:mrow>
                  <ns3:mi>a</ns3:mi>
                  <ns3:mi>c</ns3:mi>
                  <ns3:mi>t</ns3:mi>
                </ns3:mrow>
              </ns3:msub>
              <ns3:mo>×</ns3:mo>
              <ns3:msup>
                <ns3:mi>e</ns3:mi>
                <ns3:mfrac>
                  <ns3:mi>-1</ns3:mi>
                  <ns3:mrow>
                    <ns3:mi>R</ns3:mi>
                    <ns3:mi>k</ns3:mi>
                  </ns3:mrow>
                </ns3:mfrac>  
              </ns3:msup>
            </ns3:mrow>
          </ns3:mrow>
    
          <ns3:mi> &#160;</ns3:mi>
          <ns3:mrow>
            
            <ns3:mi>[m³/s]</ns3:mi>

          </ns3:mrow>
          
        </ns3:math>
          </imagedata>
        </imageobject>
      </mediaobject>
    </equation> </para>
    <para>The higher the assumed value of <inlineequation>
        <ns3:math display="inline">
          <ns3:mrow>
            <ns3:mi>T</ns3:mi>
            <ns3:mi>A</ns3:mi>
          </ns3:mrow>
        </ns3:math>
      </inlineequation>, the faster does the runoff wave move within a certain time span and the
      less water remains in the channel.</para>
    <para>For further information see also <citetitle><xref linkend="Krause_2005"
      /></citetitle>.</para>
  </sect2>
    <bibliography>
      <title>Literature</title>
      <biblioentry  xml:id="Krause_2005" xreflabel="Krause et al. 2005">
        <abbrev>Krause et al. 2005</abbrev>
        <authorgroup>
          <author><personname><firstname>P.</firstname><surname>Krause</surname></personname></author>
          <author><personname><firstname>D.</firstname><surname>Boyle</surname></personname></author>
          <author><personname><firstname>F.</firstname><surname>Bäse</surname></personname></author>
        </authorgroup>
        <title>Comparison of different efficiency criteria for hydrological model assessment</title>
        <citetitle pubwork="journal">Advances in Geosiences</citetitle>
        <volumenum>5</volumenum>
        <pagenums>89-97</pagenums>
        <pubdate>2005</pubdate>
      </biblioentry>
    </bibliography>
</sect1>
