<?xml version="1.0" encoding="UTF-8"?>
<project name="jams-common-tasks" default="default" basedir=".">
    <description>Common tasks for the JAMS projects builds.</description>

    <property file="../../JAMSmain/src/resources/text/version.txt"/>
    <property file="../../build/jams.properties"/>

    <taskdef resource="net/sf/antcontrib/antcontrib.properties">
        <classpath>
            <pathelement location="../../build/antlib/ant-contrib-1.0b3.jar"/>
        </classpath>
    </taskdef>

    <target name="-post-jar_">
        <!--copy file="${dist.jar}" tofile="${bin.dir}/${application.title}-${main.majorversion}.${main.minorversion}.jar"/-->
        <!--echo>=======>${application.title}</echo-->
        <if>
            <or>
                <!--equals arg1="${application.title}" arg2="jams-api"/-->
                <equals arg1="${application.title}" arg2="jams-components"/>
                <equals arg1="${application.title}" arg2="jams-main"/>
                <equals arg1="${application.title}" arg2="jams-starter"/>
            </or>
            <then>
                <!--echo>copying jar and libs to ${bin.dir}/lib</echo-->
                <if>
                    <equals arg1="${application.title}" arg2="jams-api"/>
                    <then>
                        <copy file="${dist.jar}" tofile="${bin.dir}/${application.title}${api.postfix}.jar"/>
                    </then>
                    <else>
                        <copy file="${dist.jar}" tofile="${bin.dir}/${application.title}${main.postfix}.jar"/>
                    </else>
                </if>
            </then>
        </if>
        <if>
            <or>
                <equals arg1="${application.title}" arg2="jams-starter"/>
            </or>
            <then>
                <copy file="dist/lib/jams-remote.jar" tofile="${bin.dir}/lib/jams-remote.jar"/>
            </then>
            <else>
                <copy todir="${bin.dir}/lib">
                    <fileset dir="dist/lib">
                        <!--exclude name="**/*jams-components.jar"/-->
                    </fileset>
                </copy>
            </else>
        </if>

    </target>

    <target name="-post-jar">

        <echo>---------------------${application.title}</echo>
        <if>
            <or>
                <equals arg1="${application.title}" arg2="jams-components"/>
                <equals arg1="${application.title}" arg2="jams-main"/>
                <equals arg1="${application.title}" arg2="jams-starter"/>
            </or>
            <then>
                <if>
                    <equals arg1="${application.title}" arg2="jams-api"/>
                    <then>
                        <copy file="${dist.jar}" tofile="${bin.dir}/${application.title}${api.postfix}.jar"/>
                    </then>
                    <else>
                        <copy file="${dist.jar}" tofile="${bin.dir}/${application.title}${main.postfix}.jar"/>
                    </else>
                </if>
            </then>
        </if>

        <if>
            <equals arg1="${application.title}" arg2="jams-remote"/>
            <then>
                <copy file="${dist.jar}" todir="${bin.dir}/lib"/>
            </then>
        </if>

        <if>
            <available file="dist/lib" type="dir"/>
            <then>
                <echo>---------------------found dist/lib</echo>
                <copy todir="${bin.dir}/lib">
                    <fileset dir="dist/lib">
                        <!--exclude name="**/*jams-components*.jar"/-->
                    </fileset>
                </copy>
            </then>
        </if>


        <!--if>
            <equals arg1="${application.title}" arg2="jams-starter"/>
            <then>
                <copy file="${bin.dir}/lib/jams-components.jar" todir="${bin.dir}"/>
                <copy file="${bin.dir}/lib/jams-main.jar" todir="${bin.dir}"/>
            </then>
        </if-->

    </target>
    <target name="-post-clean">
        <delete>
            <fileset dir="${bin.dir}" includes="**/${application.title}*"/>
        </delete>
    </target>
</project>
