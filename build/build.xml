<?xml version="1.0" encoding="UTF-8"?>
<project default="build">

    <taskdef resource="net/sf/antcontrib/antcontrib.properties">
        <classpath>
            <pathelement location="./antlib/ant-contrib-1.0b3.jar"/>
        </classpath>
    </taskdef>
    
    <target name="cleanbuild" depends="clean, build"/>

    <target name="cleanbin">
        <delete>
            <fileset dir="../bin" includes="**/*"/>
            <fileset dir="../bin/lib" includes="**/*"/>
        </delete>
    </target>

    <target name="build" description="Build all NetBeans projects in this directory">
        <foreach target="buildproject" param="buildxml">
            <path>
                <fileset dir="../nbprojects">
                    <include name="**/build.xml"/>
                </fileset>
            </path>
        </foreach>
    </target>

    <target name="clean" depends="cleanbin" description="Clean all NetBeans projects and delete libs in this directory">
        <foreach target="cleanproject" param="buildxml">
            <path>
                <fileset dir="../nbprojects">
                    <include name="**/build.xml"/>
                </fileset>
            </path>
        </foreach>
    </target>

    <target name="buildproject" description="Build a single NetBeans project">
        <ant antfile="${buildxml}" inheritall="false" target="jar"/>
    </target>

    <target name="cleanproject" description="Build a single NetBeans project">
        <ant antfile="${buildxml}" inheritall="false" target="clean"/>
    </target>

    <target name="buildstarter" description="Build a single NetBeans project">
        <property name="config" value="JAMS_Launcher"/>
        <ant antfile="../nbprojects/jams-starter/build.xml" inheritall="false" target="jar"/>
    </target>

    <target name="juicestarter">
        <property name="starterproj" value="jams-starter"/>
        <ant antfile="../nbprojects/${starterproj}/build.xml" inheritall="false" target="jar">
            <property name="config" value="JUICE"/>
        </ant>
        <property file="jams.properties"/>
        <move file="../bin/${starterproj}${main.postfix}.jar" tofile="../bin/juice-starter${main.postfix}.jar"/>
    </target>

    <target name="jamsstarter">
        <property name="starterproj" value="jams-starter"/>
        <ant antfile="../nbprojects/jams-starter/build.xml" inheritall="false" target="jar">
            <property name="config" value="JAMS_Launcher"/>
        </ant>
        <property file="jams.properties"/>
        <move file="../bin/${starterproj}${main.postfix}.jar" tofile="../bin/jams-starter${main.postfix}.jar"/>
    </target>

    <target name="remotestarter">
        <property name="starterproj" value="jams-starter"/>
        <ant antfile="../nbprojects/jams-starter/build.xml" inheritall="false" target="jar">
            <property name="config" value="JAMS_Remote"/>
        </ant>
        <property file="jams.properties"/>
        <move file="../bin/${starterproj}${main.postfix}.jar" tofile="../bin/jamsremote-starter${main.postfix}.jar"/>
    </target>
</project>
